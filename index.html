<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="Content-Language" content="en_US" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Newsletter Generator v2</title>
    <link rel="icon" href="imgs\icons8-news-128.png" />

    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-121992018-3"></script>
    <script>
      window.dataLayer = window.dataLayer || [];

      function gtag() {
        dataLayer.push(arguments);
      }
      gtag("js", new Date());

      gtag("config", "UA-121992018-3");
    </script>

    <!-- Misc -->
    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto|Roboto+Condensed&display=swap" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css" integrity="sha512-DTOQO9RWCH3ppGqcWaEA1BIZOC6xxalwEsw9c2QQeAIftl+Vegovlnee1c9QX4TctnWMn13TZye+giMm8e2LwA==" crossorigin="anonymous" referrerpolicy="no-referrer" />
    <script src="https://html2canvas.hertzen.com/dist/html2canvas.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js" integrity="sha512-qZvrmS2ekKPF2mSznTQsxqPgnpkI4DNTlrdUmTzrDgektczlKNRRhy5X5AAOnx5S09ydFYWWNSfcEqDTTHgtNA==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js" integrity="sha512-GsLlZN/3F2ErC5ifS5QtgpiJtWd43JWSuIgh7mbzZ8zBps+dvLusV+eNQATqgA/HdeKFVgA5v3S/cIrLF7QnIg==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>

    <!-- VueJS -->
    <script src="https://unpkg.com/vue@2.7.16/dist/vue.min.js"></script>

    <!-- TinyMCE -->
    <script src="https://cdn.tiny.cloud/1/eqepoqfy8y9ftr5kx84v4zm1og0ptew3yuwviio2jzd1meo0/tinymce/6/tinymce.min.js" referrerpolicy="origin"></script>

    <!-- Vue Snotify -->
    <link rel="stylesheet" href="https://unpkg.com/vue-snotify@3.2.1/styles/material.css" />
    <script src="https://unpkg.com/vue-snotify@3.2.1/vue-snotify.min.js"></script>

    <!-- Styles -->
    <link rel="stylesheet" href="css\styles.css" />
  </head>

  <body>
    <div id="body-wrapper">
      <aside
        id="sidebar"
        @mouseover="app.sidebarHover = true"
        @mouseleave="app.sidebarHover = false"
        :class="{open: app.sidebarHover || app.sidebarStuck, stuck: app.sidebarStuck}"
      >
        <span class="sidebar-title">
          <i class="fa fa-newspaper fa-2x"></i>
          <p class="collapsed">Newsletter Generator</p>
        </span>
        <a class="sidebar-pin" @click="app.sidebarStuck = !app.sidebarStuck"><i class="fas fa-thumbtack"></i></a>
        <ul class="sidebar-menu">
          <li class="sidebar-item" :class="{active: app.activeView === 'setup'}" @click="app.activeView = 'setup'; scrollToTop()">
            <i class="fa fa-toolbox fa-2x"></i>
            <p class="collapsed">Setup</p>
          </li>
          <li class="sidebar-item" :class="{active: app.activeView === 'edit'}" @click="app.activeView = 'edit'; scrollToTop()">
            <i class="fa fa-edit fa-2x"></i>
            <p class="collapsed">Edit Items</p>
          </li>
          <li class="sidebar-item" :class="{active: app.activeView === 'preview'}" @click="app.activeView = 'preview'; scrollToTop()">
            <i class="fa fa-eye fa-2x"></i>
            <p class="collapsed">Preview</p>
          </li>
        </ul>
        <span class="sidebar-split"></span>
        <ul class="sidebar-menu">
          <li class="sidebar-item" :class="{active: app.activeView === 'use'}" @click="app.activeView = 'use'; scrollToTop()">
            <i class="fa fa-file-export fa-2x"></i>
            <p class="collapsed">Use Newsletter</p>
          </li>
          <li class="sidebar-item" :class="{active: app.activeView === 'load'}" @click="app.activeView = 'load'; scrollToTop()">
            <i class="fas fa-clone fa-2x"></i>
            <p class="collapsed">Load / Save</p>
          </li>
        </ul>
        <span class="sidebar-split"></span>
        <ul class="sidebar-menu">
          <li class="sidebar-item" :class="{active: app.activeView === 'settings'}" @click="app.activeView = 'settings'; scrollToTop()">
            <i class="fa fa-cog fa-2x"></i>
            <p class="collapsed">Settings</p>
          </li>
          <li class="sidebar-item" :class="{active: app.activeView === 'help'}" @click="app.activeView = 'help'; scrollToTop()">
            <i class="far fa-question-circle fa-2x"></i>
            <p class="collapsed">Help</p>
          </li>
        </ul>
        <span class="footer">
          Randy Bimm
          <br />&copy; 2020</span
        >
      </aside>
      <aside id="preview" :class="{large: app.activeView == 'preview'}" ref="preview">
        <!-- <resizehandle othercontainer="#main" mincontainer="830" minother="700"></resizehandle> -->
        <div class="preview-header">
          <h3>Newsletter Preview</h3>
        </div>
        <div class="preview-body">
          <div ref="newsletterwrapper" id="newsletterwrapper">
            <table
              ref="newsletter"
              id="newsletter"
              width="800"
              align="center"
              role="presentation"
              border="0"
              cellpadding="0"
              cellspacing="0"
              class="no-borders"
              style="border-collapse: collapse; mso-table-lspace: 0pt; mso-table-rspace: 0pt;"
              :style="{'background-color': styles.backgroundColor}"
            >
              <tr>
                <td style="padding: 0">
                  <p v-html="newsletter.previewText" style="font-size: 1pt; text-align: center" :style="{color: styles.backgroundColor}"></p>
                  <table
                    id="newsletter-content"
                    align="center"
                    width="800"
                    role="presentation"
                    border="0"
                    cellpadding="0"
                    class="no-borders"
                    style="margin: 0 auto; border-collapse: separate; mso-table-lspace: 0pt; mso-table-rspace: 0pt;"
                    :cellspacing="styles.post.spacing"
                    :style="{'border-spacing': '0 '+styles.post.spacing+'px'}"
                  >
                    <!-- HEADER -->
                    <tr v-if="settings.header.style == '1'" id="newsletter-header">
                      <td colspan="2" :style="{'border': styles.header.borderWidth+'px solid '+styles.header.borderColour}" style="padding: 0; line-height: 0;">
                        <img :src="settings.header.image" width="800" alt="Newsletter Header" style="display: block; width: 100%; max-width: 800px; height: auto; border: 0;" />
                      </td>
                    </tr>
                    <tr v-if="settings.header.style == '2'" id="newsletter-header" style="text-align: center" :style="{'background-color': styles.header.backgroundColor}">
                      <td valign="middle" style="padding: 20px; font-family: 'Muli', Helvetica, Arial, sans-serif;" colspan="2">
                        <h2 style="margin: 0" :style="{color: styles.header.textColor}">{{settings.header.titles.title}}</h2>
                        <h4 style="margin: 0" :style="{color: styles.header.textColor}">{{settings.header.titles.subtitle}}</h4>
                      </td>
                    </tr>
                    <tr v-if="settings.header.style == '3'" id="newsletter-header" :style="{'background-color': styles.header.backgroundColor}">
                      <td valign="middle" style="padding: 0; font-family: 'Muli', Helvetica, Arial, sans-serif;" colspan="2">
                        <div v-html="settings.header.html" :style="{color: styles.header.textColor}"></div>
                      </td>
                    </tr>

                    <!-- CONTENT -->
                    <tr v-for="(post, pos) in posts">
                      <td :style="{'padding-top': styles.post.spacing+'px', 'padding-bottom': pos === posts.length - 1 ? styles.post.spacing+'px' : '0', 'padding-left': '0', 'padding-right': '0'}" class="newsletter-body">
                        <table
                          role="presentation"
                          class="no-borders"
                          :class="{'skeleton-preview': post.skeleton}"
                          width="800"
                          style="width: 800px; border-collapse: collapse; mso-table-lspace: 0pt; mso-table-rspace: 0pt;"
                          border="0"
                          cellspacing="0"
                          cellpadding="0"
                          :style="{'background-color': getPostStyle(pos, 'backgroundColor'),'border-radius': getPostStyle(pos, 'borderRadius')+'px', '-webkit-border-radius': getPostStyle(pos, 'borderRadius')+'px', '-moz-border-radius': getPostStyle(pos, 'borderRadius')+'px'}"
                        >
                          <!-- 'box-shadow': post.shadow != null ? post.shadow ? '0 3px 6px rgba(0,0,0,0.16), 0 3px 6px rgba(0,0,0,0.23)' : '' : styles.post.shadow ? '0 3px 6px rgba(0,0,0,0.16), 0 3px 6px rgba(0,0,0,0.23)' : '', -->

                          <tr v-if="post.skeleton">
                            <!-- Skeleton preview post -->
                            <td width="200" valign="top" style="width: 200px; padding: 20px;">
                              <div class="skeleton-loader" style="width: 200px; height: 120px;"></div>
                            </td>
                            <td width="560" style="width: 560px; padding: 20px; font-family: 'Muli', Helvetica, Arial, sans-serif; vertical-align: top;">
                              <div class="skeleton-loader" style="height: 24px; width: 60%; margin-bottom: 8px;"></div>
                              <div class="skeleton-loader" style="height: 14px; width: 100%; margin-bottom: 4px;"></div>
                              <div class="skeleton-loader" style="height: 14px; width: 100%; margin-bottom: 4px;"></div>
                              <div class="skeleton-loader" style="height: 14px; width: 85%;"></div>
                            </td>
                          </tr>

                          <tr v-else>
                            <!-- If image in post -->
                            <td v-if="post.img" width="200" valign="top" style="width: 200px; padding: 20px;">
                              <!-- <div style="background-position: center center; background-repeat: no-repeat; background-size: contain; height: 200px; width: 100%" height="200px" width="100%"  :style="{'background-image': 'url('+post.img+')'}"> -->
                              <img :src="post.img" height="auto" width="200" :alt="'Post #'+ pos + ' Thumbnail'" style="display: block; max-width: 200px; height: auto; border: 0;" />
                            </td>
                            <td v-if="post.img" width="560" style="width: 560px; padding: 20px; font-family: 'Muli', Helvetica, Arial, sans-serif; vertical-align: top;">
                              <div style="margin-bottom: 0" v-html="post.title" :style="{'color': getPostStyle(pos, 'textColor')}"></div>
                              <div
                                v-if="post.date != '<p><br></p>'"
                                style="font-size: 0.75em;"
                                :style="{'color': getPostStyle(pos, 'textColor')}"
                                v-html="post.date"
                              ></div>
                              <div :style="{'color': getPostStyle(pos, 'textColor')}" v-html="post.desc"></div>

                              <table role="presentation" class="no-borders" v-if="post.link" width="100%" border="0" cellspacing="0" cellpadding="0" style="mso-table-lspace: 0pt; mso-table-rspace: 0pt;">
                                <tr>
                                  <td>
                                    <table
                                      role="presentation"
                                      class="no-borders"
                                      border="0"
                                      cellspacing="0"
                                      cellpadding="0"
                                      style="mso-table-lspace: 0pt; mso-table-rspace: 0pt;"
                                      :style="{'width': getPostStyle(pos, 'buttonWidth') + '%'}"
                                      :align="getPostStyle(pos, 'buttonAlign')"
                                    >
                                      <tr>
                                        <td
                                          :bgcolor="getPostStyle(pos, 'buttonWidth') != 0 ? getPostStyle(pos, 'buttonBackgroundColor') : ''"
                                          style="padding: 12px 18px; border-radius: 3px; -webkit-border-radius: 3px; -moz-border-radius: 3px; mso-padding-alt: 12px 18px;"
                                          align="center"
                                        >
                                          <a target="_blank" :href="post.link" style="text-decoration: none; display: inline-block; font-family: 'Muli', Helvetica, Arial, sans-serif; font-weight: bold;" :style="{'color': getPostStyle(pos, 'buttonTextColor')}"
                                            ><span v-if="post.linkLabel != null && post.linkLabel != ''" v-html="post.linkLabel"></span><span v-else>Read More</span></a
                                          >
                                        </td>
                                      </tr>
                                    </table>
                                  </td>
                                </tr>
                              </table>
                            </td>

                            <!-- If no image in post -->
                            <td v-else width="780" style="width: 780px; padding: 20px; font-family: 'Muli', Helvetica, Arial, sans-serif; vertical-align: top;" colspan="2">
                              <div style="margin-bottom: 0" :style="{'color': getPostStyle(pos, 'textColor')}" v-html="post.title"></div>
                              <div
                                v-if="post.date != '<p><br></p>'"
                                style="font-size: 0.75em;"
                                :style="{'color': getPostStyle(pos, 'textColor')}"
                                v-html="post.date"
                              ></div>
                              <div :style="{'color': getPostStyle(pos, 'textColor')}" v-html="post.desc"></div>
                              <table role="presentation" class="no-borders" v-if="post.link" width="100%" border="0" cellspacing="0" cellpadding="0" style="mso-table-lspace: 0pt; mso-table-rspace: 0pt;">
                                <tr>
                                  <td>
                                    <table
                                      role="presentation"
                                      class="no-borders"
                                      border="0"
                                      cellspacing="0"
                                      cellpadding="0"
                                      style="mso-table-lspace: 0pt; mso-table-rspace: 0pt;"
                                      :style="{'width': getPostStyle(pos, 'buttonWidth') + '%'}"
                                      :align="getPostStyle(pos, 'buttonAlign')"
                                    >
                                      <tr>
                                        <td
                                          :bgcolor="getPostStyle(pos, 'buttonWidth') != 0 ? getPostStyle(pos, 'buttonBackgroundColor') : ''"
                                          style="padding: 12px 18px; border-radius: 3px; -webkit-border-radius: 3px; -moz-border-radius: 3px; mso-padding-alt: 12px 18px;"
                                          align="center"
                                        >
                                          <a
                                            target="_blank"
                                            :href="post.link"
                                            style="text-decoration: none; display: inline-block; font-family: 'Muli', Helvetica, Arial, sans-serif; font-weight: bold;"
                                            :style="{'color': getPostStyle(pos, 'buttonTextColor')}"
                                            ><span v-if="post.linkLabel != null && post.linkLabel != ''" v-html="post.linkLabel"></span><span v-else>Read More</span></a
                                          >
                                        </td>
                                      </tr>
                                    </table>
                                  </td>
                                </tr>
                              </table>
                            </td>
                          </tr>
                        </table>
                      </td>
                    </tr>

                    <!-- FOOTER -->

                    <tr class="newsletter-footer" v-if="settings.footer.style == '1'">
                      <td :style="{'background-color': styles.footer.backgroundColor}" valign="middle" style="padding: 20px; font-family: 'Muli', Helvetica, Arial, sans-serif;">
                        <p
                          v-if="settings.footer.preset.website || settings.footer.preset.social.facebook || settings.footer.preset.social.linkedin || settings.footer.preset.social.twitter"
                          style="margin: 0; margin-bottom: 10px; text-align: center; color: #fff"
                        >
                          <a v-if="settings.footer.preset.website" :href="settings.footer.preset.website" target="_blank" :style="{color: styles.footer.linkColor}">Website</a>
                          <span v-if="settings.footer.preset.social.facebook"
                            ><span v-if="settings.footer.preset.website"> | </span
                            ><a :href="settings.footer.preset.social.facebook" target="_blank" :style="{color: styles.footer.linkColor}">Facebook</a></span
                          >
                          <span v-if="settings.footer.preset.social.linkedin"
                            ><span v-if="settings.footer.preset.website || settings.footer.preset.social.facebook"> | </span
                            ><a :href="settings.footer.preset.social.linkedin" target="_blank" :style="{color: styles.footer.linkColor}">LinkedIn</a></span
                          >
                          <span v-if="settings.footer.preset.social.twitter"
                            ><span v-if="settings.footer.preset.website || settings.footer.preset.social.facebook || settings.footer.preset.social.linkedin"> | </span
                            ><a :href="settings.footer.preset.social.twitter" target="_blank" :style="{color: styles.footer.linkColor}">Twitter</a></span
                          >
                          <span v-if="settings.footer.preset.social.instagram"
                            ><span
                              v-if="settings.footer.preset.website || settings.footer.preset.social.facebook || settings.footer.preset.social.linkedin || settings.footer.preset.social.twitter"
                            >
                              | </span
                            ><a :href="settings.footer.preset.social.instagram" target="_blank" :style="{color: styles.footer.linkColor}">Instagram</a></span
                          >
                        </p>
                        <h3 v-html="settings.footer.preset.name" v-if="settings.footer.preset.name" style="margin: 0; margin-bottom: 10px; text-align: center" :style="{color: styles.footer.textColor}">
                          
                        </h3>
                        <p
                          v-if="settings.footer.preset.location.address || settings.footer.preset.location.city || settings.footer.preset.location.postal"
                          style="margin: 0; text-align: center"
                          :style="{color: styles.footer.textColor}"
                        >
                          <span v-if="settings.footer.preset.location.address" :style="{color: styles.footer.textColor}">{{settings.footer.preset.location.address}}</span>
                          <span v-if="settings.footer.preset.location.city" :style="{color: styles.footer.textColor}"
                            ><span v-if="settings.footer.preset.location.address"> | </span>{{settings.footer.preset.location.city}}, {{settings.footer.preset.location.province}}
                          </span>
                          <span v-if="settings.footer.preset.location.postal" :style="{color: styles.footer.textColor}"
                            ><span v-if="settings.footer.preset.location.address || settings.footer.preset.location.city"> | </span>{{settings.footer.preset.location.postal}}</span
                          >
                        </p>
                        <p v-if="settings.footer.preset.phone" style="margin: 0; margin-bottom: 10px; text-align: center" :style="{color: styles.footer.textColor}">
                          {{settings.footer.preset.phone}}
                        </p>
                        <br v-else>
                        <p
                          style="margin: 0; margin-bottom: 5px; font-size: 10px; text-align: center"
                          :style="{color: styles.footer.textColor}"
                        >
                          Copyright &copy; {{(new Date().getFullYear())}}, All rights reserved. <br />
                          NOTICE: This message is only to be read by the addressee and is not for public distribution. The sender is not responsible for distribution of this
                          message beyond the addressee intended. All information in this message is confidential to the addressee and should be treated as such. To ensure that trading instructions are received and executed timely and accurately, please do not send any trading instructions via e-mail.
                          <span v-if="settings.footer.preset.phone">Please contact directly at {{settings.footer.preset.phone}}.</span
                          ><span v-else>Please contact directly by phone.</span><br />
                          <br />
                          <span v-if="settings.footer.preset.disclaimer.licenses.mfda">Mutual fund dealing representatives (“mutual fund advisors”) registered with Manulife Wealth Inc. offer mutual funds.</span>
                          <span v-if="settings.footer.preset.disclaimer.licenses.iiroc">Investment dealer dealing representatives (“investment advisors”) registered with Manulife Wealth Inc. offer stocks, bonds, and mutual funds.</span>
                          <span v-if="settings.footer.preset.disclaimer.licenses.msii">
                            Insurance products and services are offered through Manulife Wealth Insurance Services Inc.
                          </span>
                          <span v-else-if="settings.footer.preset.disclaimer.insuranceOBA">
                            Insurance products and services are offered through {{settings.footer.preset.disclaimer.insuranceOBA}}.
                          </span>
                          <span v-if="settings.footer.preset.disclaimer.banking">
                            Banking products and services are offered by referral arrangements through our related company Manulife Bank of Canada, additional disclosure
                            information will be provided upon referral.
                          </span>
                          Please confirm with your advisor which company you are dealing with for each of your products and services.
                          <br />
                          <span  v-if="settings.footer.preset.disclaimer.logo">
                            <br />
                            This publication contains opinions of the writer and may not reflect opinions of the Advisor and Manulife Wealth Inc. and/or Manulife Wealth Insurance Services Inc. (collectively, “Manulife Wealth"). The information contained herein was obtained from sources believed to be reliable.
                             No representation, or warranty, express or implied, is made by the writer, Manulife Wealth or any other person as to its accuracy, completeness or correctness. This publication is not an offer to sell or a solicitation of an offer to buy any of the securities. The securities discussed in this publication may not be eligible for sale in some jurisdictions. If you are not a Canadian resident, this report should not have been delivered to you. This publication is not meant to provide legal, financial, tax or investment advice. As each situation is different, you should consult your own professional advisors for advice based on your specific circumstances.
                          <br />
                          <br />
                          <img
                            :src="isLight(styles.footer.textColor) ? 'https://library.siteforward.ca/images/english/Manulife_Wealth_linear_reversed_rgb.png' : 'https://library.siteforward.ca/images/english/Manulife_Wealth_linear_rgb.png'"
                            width="350"
                            height="auto"
                            alt="Manulife Wealth Logo"
                            style="display: block; max-width: 350px; height: auto; border: 0; margin: 0 auto;"
                          /><br />
                          <em
                            ><a href="https://www.manulifewealth.ca/clients/en/corporate-disclaimers" target="_blank" :style="{color: styles.footer.linkColor}"
                              >Legal and Disclaimers | Privacy Policy</a></em
                          >
                        </span>
                        </p>
                        <p v-if="settings.footer.preset.email" style="margin: 0; font-size: 12px; text-align: center">
                          <a
                            :href="'mailto:' + settings.footer.preset.email + '?subject=Unsubscribe from newsletters&body=Hi,%0d%0aPlease remove my email address from your newsletter list.%0d%0aI wish to be removed because:__________.%0d%0aThanks,'"
                            :style="{color: styles.footer.linkColor}"
                            >Unsubscribe from newsletters</a
                          >
                        </p>
                      </td>
                    </tr>
                    <tr class="newsletter-footer" v-else-if="settings.footer.style == '2'">
                      <td :style="{'background-color': styles.footer.backgroundColor}" valign="middle" style="padding: 20px; font-family: 'Muli', Helvetica, Arial, sans-serif;">
                        <div v-html="settings.footer.html" :style="{color: styles.footer.textColor}"></div>
                      </td>
                    </tr>
                  </table>
                </td>
              </tr>
            </table>
          </div>
        </div>
      </aside>
      <main id="main" ref="main">
        <vue-snotify></vue-snotify>

        <div id="setup" class="main-view" :class="{open: app.activeView === 'setup'}">
          <div class="card">
            <h3 class="card-title">Email Preview Text</h3>
            <span class="card-title-icon"
              ><i class="fas fa-question-circle tool-icon"></i
              ><span class="card-title-help" style="width: 300px">
                <p>
                  <strong><i class="fas fa-envelope-open-text"></i> Preview Text</strong><br />
                  This text appears below the subject line in email inboxes. It gives recipients a quick preview of what's inside before they open your newsletter.
                </p>
              </span></span
            >
            <div class="form-item border">
              <input type="text" id="previewText" v-model="newsletter.previewText" required title=" " />
              <label for="previewText">Preview Text</label>
            </div>
          </div>
          <div class="card">
            <h3 class="card-title">Load Blog Posts From Your Website</h3>
            <span class="card-title-icon"
              ><i class="fas fa-question-circle tool-icon"></i
              ><span class="card-title-help" style="width: 300px">
                <p>
                  <strong><i class="fas fa-mail-bulk"></i> Load Multiple Posts</strong><br />
                  Enter your blog page URL to import several posts at once. Use the main blog page address, not individual article links.
                </p>
                <p>
                  <strong><i class="fas fa-envelope"></i> Load Individual Posts</strong><br />
                  Enter a specific article URL to import just one post.
                </p>

                <p>
                  If you're using SiteForward's RSS Feed you can load posts from:
                  <a href="http://siteforward.ca/rss-feed" target="_blank">http://siteforward.ca/rss-feed</a>
                </p>
              </span></span
            >
            <p>Load Multiple Posts</p>
            <div class="form-item border split">
              <div>
                <input type="text" id="loadPosts" required ref="loadPosts" title=" " />
                <label for="loadPosts">Post Page's URL</label>
              </div>
              <input type="number" id="loadPostsCount" required ref="loadPostsCount" value="3" class="compact" aria-label="Number of posts to load" />
              <button @click="loadPostsFromURL"><i class="fas fa-file-import"></i> Load Posts</button>
            </div>
            <p>Load Individual Posts</p>
            <div class="form-item border split">
              <div>
                <input type="text" id="loadPost" required ref="loadPost" title=" " />
                <label for="loadPost">Post's URL</label>
              </div>
              <button @click="loadPostFromURL"><i class="fas fa-file-import"></i> Load Post</button>
            </div>
          </div>
          <div class="card">
            <h3 class="card-title">Header Settings</h3>
            <div class="accordion" :class="{open: settings.header.style == 0}" @click="settings.header.style = 0">
              <div class="accordion-title">
                <p>No Header</p>
                <div class="selector"></div>
              </div>
            </div>
            <div class="accordion" :class="{open: settings.header.style == 1}" @click="settings.header.style = 1">
              <div class="accordion-title">
                <p>Use Image</p>
                <div class="selector"></div>
              </div>
              <div class="accordion-content">
                <div class="form-item border">
                  <input type="text" id="header-image" v-model="settings.header.image" required title=" " />
                  <label for="header-image">Header Image URL</label>
                </div>
                <!-- <p class="smallerText">Looking to create a custom banner? - Try the <a href="#"
                                    @click="app.activeView = 'banner'; scrollToTop()">custom banner creator</a> in the
                                tools section in the left navigation or you can try <a
                                    href="https://www.canva.com/design?create&width=800&height=230&units=px&schema=web-2" target="_blank">Canva</a>.
                                <br>Once the banner is created you will need to upload the banner to your website and
                                copy the URL into here
                            </p> -->
                <p class="smallerText">
                  Looking to create a custom banner? - Try
                  <a href="https://www.canva.com/design?create&width=800&height=230&units=px&schema=web-2" target="_blank">Canva</a>. <br />Once the banner is created you will need
                  to upload the banner to your website and copy the URL into here
                </p>
              </div>
            </div>
            <div class="accordion" :class="{open: settings.header.style == 2}" @click="settings.header.style = 2">
              <div class="accordion-title">
                <p>Use Titles</p>
                <div class="selector"></div>
              </div>
              <div class="accordion-content">
                <div class="form-item border">
                  <input type="text" id="header-titles-title" v-model="settings.header.titles.title" required title=" " />
                  <label for="header-titles-title">Header Title</label>
                </div>
                <div class="form-item border">
                  <input type="text" id="header-titles-subtitle" v-model="settings.header.titles.subtitle" required title=" " />
                  <label for="header-titles-subtitle">Header Subtitle</label>
                </div>
              </div>
            </div>
            <div class="accordion" :class="{open: settings.header.style == 3}" @click="settings.header.style = 3">
              <div class="accordion-title">
                <p>Custom Header</p>
                <div class="selector"></div>
              </div>
              <div class="accordion-content">
                <div class="form-item border" :style="{'background-color': styles.header.backgroundColor, color: styles.header.textColor}" style="padding: 5px; border-radius: 5px;">
                  <editable :key="app.forceRerender" id="header-html" v-model="settings.header.html" :value="settings.header.html"> </editable>
                  <label for="header-html">Header Content</label>
                </div>
              </div>
            </div>
          </div>
          <div class="card">
            <h3 class="card-title">Footer Settings</h3><span class="card-title-icon"
            ><i class="fas fa-question-circle tool-icon"></i
            ><span class="card-title-help" style="width: 350px">
              <p>
                <strong>Using the template?</strong><br />
                When adding your name, always include your title and legal entity (e.g., "Investment Advisor, Manulife Wealth Inc.").</p>
                <p><strong>Formatting Tip:</strong><br>To keep your signature on separate lines, hold <strong>Shift + Enter</strong> between each line:<br><br>Your Name<br>Investment Advisor, Manulife Wealth Inc.
              </p>
            </span></span
          >
            <div class="accordion" :class="{open: settings.footer.style == 0}" @click="settings.footer.style = 0">
              <div class="accordion-title">
                <p>No Footer</p>
                <div class="selector"></div>
              </div>
            </div>
            <div class="accordion" :class="{open: settings.footer.style == 1}" @click="settings.footer.style = 1">
              <div class="accordion-title">
                <p>Use Template</p>
                <div class="selector"></div>
                
              </div>
              <div class="accordion-content">
                <div class="form-item border split even">
                  <div>
                    <editable :key="app.forceRerender" id="footer-preset-name" v-model="settings.footer.preset.name" :value="settings.footer.preset.name"> </editable>
                    <label for="footer-preset-name">Trade Name / OBA / Name</label>
                  </div>
                  <div>
                    <input type="text" id="footer-preset-email" v-model="settings.footer.preset.email" required title=" " />
                    <label for="footer-preset-email">Email</label>
                  </div>
                </div>
                <div class="form-item border split even">
                  <div>
                    <input type="text" id="footer-preset-phone" v-model="settings.footer.preset.phone" required title=" " />
                    <label for="footer-preset-phone">Phone</label>
                  </div>
                  <div>
                    <input type="text" id="footer-preset-website" v-model="settings.footer.preset.website" required title=" " />
                    <label for="footer-preset-website">Website</label>
                  </div>
                </div>
                <div class="form-item border split even">
                  <div>
                    <input type="text" id="footer-preset-social-facebook" v-model="settings.footer.preset.social.facebook" required title=" " />
                    <label for="footer-preset-social-facebook">Facebook Page</label>
                  </div>
                  <div>
                    <input type="text" id="footer-preset-social-linkedin" v-model="settings.footer.preset.social.linkedin" required title=" " />
                    <label for="footer-preset-social-linkedin">LinkedIn Page</label>
                  </div>
                </div>
                <div class="form-item split even">
                  <div class="border">
                    <input type="text" id="footer-preset-social-twitter" v-model="settings.footer.preset.social.twitter" required title=" " />
                    <label for="footer-preset-social-twitter">Twitter Page</label>
                  </div>
                  <div class="border">
                    <input type="text" id="footer-preset-social-instagram" v-model="settings.footer.preset.social.instagram" required title=" " />
                    <label for="footer-preset-social-instagram">Instagram Page</label>
                  </div>
                </div>
                <div class="form-item border split even">
                  <div>
                    <input type="text" id="footer-preset-location-address" v-model="settings.footer.preset.location.address" required title=" " />
                    <label for="footer-preset-location-address">Address</label>
                  </div>
                  <div>
                    <input type="text" id="footer-preset-location-city" v-model="settings.footer.preset.location.city" required title=" " />
                    <label for="footer-preset-location-city">City</label>
                  </div>
                </div>
                <div class="form-item border split even">
                  <div>
                    <input type="text" id="footer-preset-location-province" v-model="settings.footer.preset.location.province" required title=" " />
                    <label for="footer-preset-location-province">Province</label>
                  </div>
                  <div>
                    <input type="text" id="footer-preset-location-postal" v-model="settings.footer.preset.location.postal" required title=" " />
                    <label for="footer-preset-location-postal">Postal</label>
                  </div>
                </div>
                <div class="form-item border split even">
                  <div>
                    <input
                      type="checkbox"
                      id="footer-preset-disclaimer-licenses-mfda"
                      v-model="settings.footer.preset.disclaimer.licenses.mfda"
                      aria-label="Toggle using MFDA disclaimer"
                      title="Toggle using MFDA disclaimer"
                      required
                    />
                    <label for="footer-preset-disclaimer-licenses-mfda">Mutual Funds</label>
                  </div>
                  <div>
                    <input
                      type="checkbox"
                      id="footer-preset-disclaimer-licenses-iiroc"
                      v-model="settings.footer.preset.disclaimer.licenses.iiroc"
                      aria-label="Toggle using IIROC disclaimer"
                      title="Toggle using IIROC disclaimer"
                      required
                    />
                    <label for="footer-preset-disclaimer-licenses-iiroc">Investment</label>
                  </div>
                  
                  <div>
                    <input
                      type="checkbox"
                      id="footer-preset-disclaimer-licenses-msii"
                      v-model="settings.footer.preset.disclaimer.licenses.msii"
                      aria-label="Toggle using MWISI disclaimer"
                      title="Toggle using Manuilife Wealth Insurance Services Inc disclaimer"
                      required
                    />
                    <label for="footer-preset-disclaimer-licenses-msii">MWISI</label>
                  </div>
                </div>
                <div class="form-item split even">
                  <div class="border">
                    <input
                      type="checkbox"
                      id="footer-preset-disclaimer-logo"
                      v-model="settings.footer.preset.disclaimer.logo"
                      aria-label="Toggle using Manulife Wealth branding"
                      title="Toggle using Manulife Wealth branding"
                      checked
                      required
                    />
                    <label for="footer-reset-disclaimer-logo">Manulife Wealth branding</label>
                  </div>
                  <div class="border">
                    <input
                      type="checkbox"
                      id="footer-preset-disclaimer-banking"
                      v-model="settings.footer.preset.disclaimer.banking"
                      aria-label="Toggle using Banking disclaimer"
                      title="Toggle using Manulife Banking disclaimer"
                      required
                      checked
                    />
                    <label for="footer-preset-disclaimer-banking">Manulife Banking</label>
                  </div>
                  <div v-if="!settings.footer.preset.disclaimer.licenses.msii" class="border">
                    <input type="text" id="footer-preset-disclaimer-insuranceOBA" v-model="settings.footer.preset.disclaimer.insuranceOBA" required title=" " />
                    <label for="footer-preset-disclaimer-insuranceOBA">Insurance OBA</label>
                  </div>
                  <div v-else><label style="
                    padding-left: 5px;
                ">Disable MWISI to change Insurance OBA</label></div>
                </div>
              </div>
            </div>
            <div class="accordion" :class="{open: settings.footer.style == 2}" @click="settings.footer.style = 2">
              <div class="accordion-title">
                <p>Custom Footer</p>
                <div class="selector"></div>
              </div>
              <div class="accordion-content expandable">
                <div class="form-item border" :style="{'background-color': styles.footer.backgroundColor, color: styles.footer.textColor}" style="padding: 5px; border-radius: 5px;">
                  <editable :key="app.forceRerender" id="footer-html" v-model="settings.footer.html" :value="settings.footer.html"> </editable>
                  <label for="footer-html">Footer Content </label>
                </div>
                <p class="smallerText">
                  Want to edit the template content? Click <a href="#" @click.prevent="importFooterTemplateIntoCustom">here</a> to copy the code and add it into the custom section.<br />
                  <strong>Warning:</strong> This WILL overwrite anything in the custom section</p>
              </div>
            </div>
          </div>
          <div class="card">
            <h3 class="card-title">Colour Settings</h3>
            <span class="card-title-icon"
              ><i class="fas fa-question-circle tool-icon"></i
              ><span class="card-title-help" style="width: 200px">
                <p>
                  <strong><i class="fas fa-palette"></i> Colour Settings</strong><br />
                  These colours apply to all posts by default. You can customize individual post colours in the Edit tab if needed.
                </p>
              </span></span
            >
            <div class="form-item split even">
              <div>
                <input id="backgroundColor" type="color" v-model="styles.backgroundColor" :class="{light: isLight(styles.backgroundColor)}" />
                <label for="backgroundColor">Background Colour</label>
              </div>
              <div></div>
            </div>
            <br />
            <div class="form-item split even">
              <div>
                <input id="headerColor" type="color" v-model="styles.header.backgroundColor" :class="{light: isLight(styles.header.backgroundColor)}" />
                <label for="headerColor">Header Background Colour</label>
              </div>
              <div>
                <input id="headerText" type="color" v-model="styles.header.textColor" :class="{light: isLight(styles.header.textColor)}" />
                <label for="headerText">Header Text Colour</label>
              </div>
            </div>

            <br />
            <div class="form-item split even">
              <div>
                <input id="buttonColor" type="color" v-model="styles.post.buttonBackgroundColor" :class="{light: isLight(styles.post.buttonBackgroundColor)}" />
                <label for="buttonColor">Button Colour</label>
              </div>
              <div>
                <input id="linkColor" type="color" v-model="styles.footer.linkColor" :class="{light: isLight(styles.footer.linkColor)}" />
                <label for="linkColor">Footer Link Colour</label>
              </div>
            </div>

            <div class="form-item split even">
              <div>
                <input id="postColor" type="color" v-model="styles.post.backgroundColor" :class="{light: isLight(styles.post.backgroundColor)}" />
                <label for="postColor">Post Background Colour</label>
              </div>
              <div>
                <input id="postText" type="color" v-model="styles.post.textColor" :class="{light: isLight(styles.post.textColor)}" />
                <label for="postText">Post Text Colour</label>
              </div>
            </div>

            <br />
            <div class="form-item split even">
              <div>
                <input id="footerColor" type="color" v-model="styles.footer.backgroundColor" :class="{light: isLight(styles.footer.backgroundColor)}" />
                <label for="footerColor">Footer Background Colour</label>
              </div>
              <div>
                <input id="footerText" type="color" v-model="styles.footer.textColor" :class="{light: isLight(styles.footer.textColor)}" />
                <label for="footerText">Footer Text Colour</label>
              </div>
            </div>
          </div>
          <div class="card">
            <h3 class="card-title">Style Settings</h3>
            <span class="card-title-icon"
              ><i class="fas fa-question-circle tool-icon"></i
              ><span class="card-title-help" style="width: 300px">
                <p>
                  <strong><i class="fas fa-pen-fancy"></i> Style Settings</strong><br />
                  These styles apply to all posts by default. You can customize individual post styles in the Edit tab if needed.
                </p>
                <p>
                  <strong><i class="fas fa-border-style"></i> Rounded Corners</strong><br />
                  Note: Rounded corners won't appear in Outlook due to email client limitations, but will display in most other email programs.
                </p>
              </span></span
            >

            <div class="form-item split even">
              <div>
                <slider min="0" max="50" v-model="styles.post.spacing" :value="styles.post.spacing" id="stylesPostSpacing">Post Spacing </slider>
              </div>
              <div>
                <slider min="0" max="50" v-model="styles.post.borderRadius" :value="styles.post.borderRadius" id="stylesPostBorderRadius"> Post Border Radius </slider>
              </div>
            </div>
            <div class="form-item split even">
              <div>
                <slider min="0" max="100" v-model="styles.post.buttonWidth" :value="styles.post.buttonWidth" id="stylesPostButtonWidth"> Minimum Button Width (%)</slider>
              </div>
              <div>
                <select id="styles-button-align" v-model="styles.post.buttonAlign" title="Button Alignment">
                  <option value="left" selected="selected">Left</option>
                  <option value="center">Center</option>
                  <option value="right">Right</option>
                </select>
                <label for="styles-button-align">Button Alignment</label>
              </div>
            </div>

            <!-- <div class="form-item split even">
              <div>
                <input id="styles-posts-shadow" type="checkbox" v-model="styles.post.shadow" class="checkbox-right">
                <label for="styles-posts-shadow">Posts Shadow</label>
              </div>
              <div>
              </div>
            </div> -->
          </div>
        </div>

        <div id="edit" class="main-view" :class="{open: app.activeView === 'edit'}">
          <div v-if="app.forceRerender"></div>
          <div class="card">
            <h3 class="card-title">Edit Newsletter</h3>
            <span class="card-title-icon" title="Add Custom Post" @click="addPost"><i class="far fa-plus-square tool-icon"></i></span>
            <div class="edit-newsletter">
              <ul class="newsletter-list">
                <li v-if="posts.length == 0">
                  <p>No Posts Loaded</p>
                </li>
                <!-- Skeleton Loader for Loading State -->
                <li
                  v-for="(post, pos) in posts"
                  v-if="post.skeleton"
                  class="card skeleton-post"
                  style="margin-bottom: 10px"
                  :key="'skeleton-'+pos"
                >
                  <div class="post">
                    <div class="skeleton-loader skeleton-post-image"></div>
                    <div class="data">
                      <div class="skeleton-loader skeleton-post-title"></div>
                      <div class="skeleton-loader skeleton-post-text"></div>
                      <div class="skeleton-loader skeleton-post-text"></div>
                      <div class="skeleton-loader skeleton-post-date"></div>
                    </div>
                  </div>
                </li>
                <!-- Regular Post -->
                <li
                  v-for="(post, pos) in posts"
                  v-if="!post.skeleton"
                  class="card"
                  :class='{light: isLight(getPostStyle(pos, "backgroundColor"))}'
                  style="margin-bottom: 10px"
                  :style="{'background-color': getPostStyle(pos, 'backgroundColor')}"
                  :key="pos"
                >
                  <div class="tool-list vertical space-even">
                    <div class="tool-list vertical space-even">
                      <i v-if="pos > 0" class="fas fa-chevron-up tool-icon" @click="movePost(0, pos)" title="Top"></i>
                      <i v-if="pos > 0" class="fas fa-sort-up tool-icon" @click="movePost(pos-1, pos)" title="Up"></i>
                    </div>
                    <div class="tool-list vertical space-even">
                      <i v-if="pos != posts.length-1" class="fas fa-sort-down tool-icon" @click="movePost(pos+1, pos)" title="Down"></i>
                      <i v-if="pos != posts.length-1" class="fas fa-chevron-down tool-icon" @click="movePost(posts.length, pos)" title="Bottom"></i>
                    </div>
                  </div>
                  <div class="post">
                    <img class="post-img" v-if="post.img" :src="post.img" :alt="'Post #'+ pos + ' Thumbnail'" loading="lazy" />
                    <div class="data">
                      <div class="form-item border" :style="{'color':getPostStyle(pos, 'textColor')}">
                        <editable :key="app.forceRerender" :id="'post-title-'+pos" v-model="post.title" :value="post.title"> </editable>
                        <label :for="'post-title-'+pos">Title</label>
                      </div>
                      <div class="form-item border" :style="{'color':getPostStyle(pos, 'textColor')}">
                        <editable :key="app.forceRerender" :id="'post-desc-'+pos" v-model="post.desc" :value="post.desc"> </editable>
                        <label :for="'post-desc-'+pos">Description</label>
                      </div>
                      <div class="form-item border" :style="{'color':getPostStyle(pos, 'textColor')}">
                        <editable :key="app.forceRerender" :id="'post-date-'+pos" v-model="post.date" :value="post.date"> </editable>
                        <label :for="'post-date-'+pos">Date</label>
                      </div>
                      <div class="form-item border split even">
                        <div>
                          <input
                            :id="'post-link-'+pos"
                            type="text"
                            v-model="post.link"
                            style="font-size: 11px"
                            :style="{'color':getPostStyle(pos, 'textColor')}"
                            required
                            title=" "
                          />
                          <label :for="'post-link-'+pos">Link</label>
                        </div>
                        <div>
                          <input
                            :id="'post-linkLabel-'+pos"
                            type="text"
                            v-model="post.linkLabel"
                            style="font-size: 11px"
                            :style="{'color':getPostStyle(pos, 'textColor')}"
                            required
                            title=" "
                          />
                          <label :for="'post-linkLabel-'+pos">Read More</label>
                        </div>
                      </div>
                      <div class="form-item border">
                        <input :id="'post-img-'+pos" type="text" v-model="post.img" style="font-size: 11px" :style="{'color':getPostStyle(pos, 'textColor')}" required title=" " />
                        <label :for="'post-img-'+pos">Image URL</label>
                      </div>
                    </div>
                  </div>
                  <span class="tool-list vertical">
                    <i class="fas fa-trash-alt tool-icon" @click="deletePost(pos)" title="Remove Post"></i>
                    <i class="far fa-clone tool-icon" @click="duplicatePost(pos)" title="Duplicate Post"></i>
                    <popup title="Post Settings">
                      <div class="form-item split even">
                        <div>
                          <input
                            :id="'post-style-backgroundColor-'+pos"
                            type="color"
                            :value='getPostStyle(pos, "backgroundColor")'
                            @input='e => editPost(pos, "style.backgroundColor", e.target.value)'
                            :class='{light: isLight(getPostStyle(pos, "backgroundColor"))}'
                            title="Customize Post Background Color"
                          />
                          <label :for="'post-style-backgroundColor-'+pos">Post Background Color</label>
                        </div>
                        <div>
                          <input
                            :id="'post-color-'+pos"
                            type="color"
                            :value='getPostStyle(pos, "textColor")'
                            @input='e=>editPost(pos, "style.textColor", e.target.value)'
                            :class='{light: isLight(getPostStyle(pos, "textColor"))}'
                            title="Customize Post Text Color"
                          />
                          <label :for="'post-color-'+pos">Post Text Color</label>
                        </div>
                      </div>
                      <div class="form-item split even">
                        <div>
                          <input
                            :id="'post-button-backgroundColor-'+pos"
                            type="color"
                            :value='getPostStyle(pos, "buttonBackgroundColor")'
                            @input='e=>editPost(pos, "style.buttonBackgroundColor", e.target.value)'
                            :class="{light: isLight(getPostStyle(pos, 'buttonBackgroundColor'))}"
                            title="Customize Button Background Color"
                          />
                          <label :for="'post-button-backgroundColor-'+pos">Post Button Background Color</label>
                        </div>
                        <div>
                          <input
                            :id="'post-button-textColor-'+pos"
                            type="color"
                            :value='getPostStyle(pos, "buttonTextColor")'
                            @input='e=>editPost(pos, "style.buttonTextColor", e.target.value)'
                            :class="{light: isLight(getPostStyle(pos, 'buttonTextColor'))}"
                            title="Customize Button Text Color"
                          />
                          <label :for="'post-button-textColor-'+pos">Post Button Text Color</label>
                        </div>
                      </div>
                      <div class="form-item border split even">
                        <slider min="0" max="100" v-model="posts[pos].style.buttonWidth" :value="getPostStyle(pos, 'buttonWidth')">Minimum Button Width (%) </slider>
                        <div>
                          <select
                            :id="'post-btnAlign-'+pos"
                            v-model="post.style.buttonAlign"
                            :value="getPostStyle(pos, 'buttonAlign')"
                            title="Customize Post Link Button Alignment"
                            aria-label="Customize Post Link Button Alignment"
                          >
                            <option value="left" selected="selected">Left</option>
                            <option value="center">Center</option>
                            <option value="right">Right</option>
                          </select>
                          <label :for="'post-btnAlign-'+pos">Link Button Alignment</label>
                        </div>
                      </div>
                      <div class="form-item" style="text-align: center; margin-top: 30px">
                        <button @click="editPost(pos, 'style', {})">Reset to default</button>
                      </div>

                      <!-- <div class="form-item border">
                          <slider min="0" max="50" v-model="post.spacing" :value="post.spacing != null ? post.spacing : styles.post.spacing">Post Spacing</slider>
                        </div> -->
                      <!-- <div class="form-item border">
                          <slider min="0" max="50" v-model="post.borderRadius" :value="post.borderRadius != null ? post.borderRadius : styles.post.borderRadius">Post Border Radius</slider>
                        </div> -->

                      <!--   <div class="form-item border">
                          <input id="post-shadow" type="checkbox" v-model="post.shadow" class="checkbox-left">
                          <label for="post-shadow">Posts Shadow</label>
                        </div> -->
                    </popup>
                  </span>
                </li>
              </ul>
            </div>
          </div>
        </div>

        <div id="load" class="main-view" :class="{open: app.activeView === 'load'}">
          <div class="card">
            <h3 class="card-title">Newsletter Management</h3>
            <span class="card-title-icon"
              ><i class="fas fa-question-circle tool-icon"></i
              ><span class="card-title-help" style="width: 400px">
                <p>
                  <strong><i class="fas fa-download"></i> Local <small>(Web browser)</small></strong
                  ><br />
                  Saves your newsletter in your browser. Quick and easy, but will be deleted if you clear your browser cache.
                </p>
                <p>
                  <strong><i class="fas fa-file-download"></i> File <small>(JSON file)</small></strong
                  ><br />
                  Downloads your newsletter as a file you can save anywhere on your computer for long-term storage and sharing.
                </p>
              </span></span
            >
            <div class="accordion" :class="{open: newsletter.data == 0}" @click="newsletter.data = 0">
              <div class="accordion-title">
                <p>Local <small>(Web browser)</small></p>
                <div class="selector"></div>
              </div>
              <div class="accordion-content">
                <p><strong>Local</strong> will let you load/save the newsletter in your web browser.</p>

                <div class="form-item split even">
                  <button @click="saveNewsletter" title="Save the newsletter"><i class="fas fa-download"></i> Save the Newsletter</button>
                  <button @click="loadNewsletter" title="Load the Newsletter"><i class="fas fa-upload"></i> Load the Newsletter</button>
                </div>
              </div>
            </div>
            <div class="accordion" :class="{open: newsletter.data == 1}" @click="newsletter.data = 1">
              <div class="accordion-title">
                <p>File <small>(JSON file)</small></p>
                <div class="selector"></div>
              </div>
              <div class="accordion-content">
                <p><strong>File</strong> will let you load/save the newsletter in a JSON file that can be moved around.</p>
                <div class="form-item split even">
                  <button @click="exportNewsletter" title="Save the newsletter to a file"><i class="fas fa-file-download"></i> Save the Newsletter</button>
                  <button @click="importNewsletter" title="Load the Newsletter from a file"><i class="fas fa-file-upload"></i> Load the Newsletter</button>
                </div>
              </div>
            </div>
          </div>
          <div class="card">
            <h3 class="card-title">Start from a Template</h3>
            <div class="row">
              <div class="col col-3">
                <p>This <strong>will</strong> overwrite your current Newsletter.</p>
                <p>Make sure to save your current newsletter if you think you may want to revert back to it.</p>
                <div class="form-item">
                  <button @click="loadTemplate()" title="Load the Template" style="margin-left: 0; margin-top: 10px"><i class="fas fa-file-download"></i> Load Template</button>
                </div>
              </div>
              <div class="col col-left">
                <img class="template-thumbnail" src="imgs/template.png" alt="Template Thumbnail" loading="lazy" />
              </div>
            </div>
          </div>
        </div>

        <div id="use" class="main-view" :class="{open: app.activeView === 'use'}">
          <div class="card">
            <h3 class="card-title">Use The Newsletter</h3>
            <span class="card-title-icon"
              ><i class="fas fa-question-circle tool-icon"></i
              ><span class="card-title-help" style="width: 400px">
                <p><strong>⚠️ Compliance Reminder:</strong><br>If your newsletter includes dealer content, submit it to Sales Communication for review through Red Oak before sending.</p>
                <p>
                  <strong><i class="fas fa-code"></i> Copy HTML Code</strong><br />
                  For pasting into email platforms that accept HTML code.
                </p>
                <p>
                  <strong><i class="fas fa-paste"></i> Copy Newsletter</strong><br />
                  For pasting directly into email programs like Outlook (no code knowledge needed).
                </p>
                <p>
                  <strong><i class="fas fa-file-download"></i> Download Preview</strong><br />
                  Saves as an HTML file you can open in any web browser.
                </p><p>
                  <strong><i class="fas fa-file-pdf"></i> Download PDF</strong><br />
                  Creates a PDF version for compliance review or sharing.
                </p>
              </span></span
            >
            
            <div class="form-item border">
              <textarea disabled v-model="newsletterHTML" style="min-height: 250px" aria-label="Newsletters HTML Code"></textarea>
            </div>
            <div class="form-item split even">
              <button @click="copyNewsletterCode"><i class="fas fa-code"></i> Copy HTML Code</button>
              <button @click="copyNewsletter"><i class="fas fa-paste"></i> Copy Newsletter</button>
              <button @click="downloadHTML"><i class="fas fa-file-download"></i> &nbsp;Download Preview</button>
              <button @click="downloadPDF"><i class="fas fa-file-pdf"></i> Download PDF</button>
            </div>
          </div>
        </div>

        <!-- PHP Banner Generation - Commented Out -->
        <!-- <div id="banner" class="main-view" :class="{open: app.activeView === 'banner'}">
          <div class="card">
            <h3 class="card-title">Create a Custom Banner Image</h3>
            <span class="card-title-icon"
              ><i class="fas fa-question-circle tool-icon"></i
              ><span class="card-title-help" style="width: 200px">
                <p>
                  <strong><i class="fa fa-image"></i> Looking for some images to use?</strong><br />Try SiteForward's image bank:<br /><a
                    href="https://siteforward.ca/tools/image-bank"
                    target="_blank"
                    >https://siteforward.ca/tools/image-bank</a
                  >
                </p>
              </span></span
            >
            <div class="form-item split even border">
              <div>
                <input id="banner-image" type="text" v-model="banner.image" required title=" " />
                <label for="banner-image">Banner Image URL</label>
              </div>
              <div>
                <select v-model="banner.align" id="banner-align">
                  <option value="top left">Top Left</option>
                  <option value="top center">Top Center</option>
                  <option value="top right">Top Right</option>

                  <option value="center left">Center Left</option>
                  <option value="center center">Center Center</option>
                  <option value="center right">Center Right</option>

                  <option value="bottom left">Bottom Left</option>
                  <option value="bottom center">Bottom Center</option>
                  <option value="bottom right">Bottom Right</option>
                </select>
                <label for="banner-align">Image Alignment:</label>
              </div>
            </div>
            <br />
            <div class="row">
              <div class="col">
                <p class="col-title">Text Controls</p>
                <div class="form-item border">
                  <input type="text" v-model="banner.title" id="banner-title" required title=" " />
                  <label for="banner-title">Banner Title</label>
                </div>
                <div class="form-item border">
                  <input type="text" v-model="banner.subtitle" id="banner-subtitle" required title=" " />
                  <label for="banner-subtitle">Banner Subtitle</label>
                </div>
                <div class="form-item border">
                  <slider min="0" max="100" v-model="banner.titleSize" :value="banner.titleSize" id="banner-titlesize">Title Size </slider>
                </div>
                <div class="form-item border">
                  <slider min="0" max="100" v-model="banner.subtitleSize" :value="banner.subtitleSize" id="banner-subtitlesize">Subtitle Size </slider>
                </div>
                <div class="form-item border">
                  <slider min="0" max="100" :value="banner.titleSpacing" v-model="banner.titleSpacing" id="banner-titlespacing">Title Spacing </slider>
                </div>
                <div class="form-item border border">
                  <slider min="-225" max="225" v-model="banner.offsetY" :value="banner.offsetY" id="banner-offsety">Text Vertical Offset </slider>
                </div>
                <div class="form-item border border">
                  <slider min="-800" max="800" v-model="banner.offsetX" :value="banner.offsetX" id="banner-offsetx">Text Horizontal Offset </slider>
                </div>
                <div class="form-item border">
                  <select v-model="banner.textAlign" id="banner-textAlign">
                    <option value="center">Center</option>
                    <option value="left">Left</option>
                    <option value="right">Right</option>
                  </select>
                  <label for="banner-textAlign">Text Alignment:</label>
                </div>
                <div class="form-item">
                  <input id="banner-color" type="color" v-model="banner.color" :class="{light: isLight(banner.color)}" />
                  <label for="banner-color">Banner Text Colour</label>
                </div>
              </div>
              <div class="col col-left col-right">
                <p class="col-title">Shadow Controls</p>
                <div class="form-item border">
                  <input id="banner-shadowEnabled" type="checkbox" v-model="banner.shadowEnabled" class="checkbox-right" />
                  <label for="banner-shadowEnabled">Banner Shadow Enabled</label>
                </div>
                <div class="form-item border">
                  <slider min="-20" max="20" v-model="banner.shadowOffsetY" :value="banner.shadowOffsetY" id="banner-shadowOffsety"> Shadow Vertical Offset </slider>
                </div>
                <div class="form-item border">
                  <slider min="-20" max="20" v-model="banner.shadowOffsetX" :value="banner.shadowOffsetX" id="banner-shadowOffsetx"> Shadow Horizontal Offset</slider>
                </div>
                <div class="form-item border">
                  <slider min="-800" max="800" v-model="banner.shadowBlur" :value="banner.shadowBlur" id="banner-shadowBlur">Shadow Blur </slider>
                </div>
                <div class="form-item">
                  <input id="banner-shadowColor" type="color" v-model="banner.shadowColor" :class="{light: isLight(banner.shadowColor)}" />
                  <label for="banner-shadowColor">Banner Shadow Colour</label>
                </div>
              </div>
              <div class="col">
                <p class="col-title">Logo Controls</p>
                <div class="form-item border">
                  <input id="banner-logo" type="text" v-model="banner.logo" required title=" " />
                  <label for="banner-logo">Banner logo URL</label>
                </div>
                <div class="form-item border">
                  <slider min="0" max="225" :value="banner.logoY" v-model="banner.logoY" id="banner-logoy">Logo Vertical Offset</slider>
                </div>
                <div class="form-item border">
                  <slider min="-800" max="800" :value="banner.logoX" v-model="banner.logoX" id="banner-logox">Logo Horizontal Offset </slider>
                </div>
                <div class="form-item border">
                  <slider min="0" max="800" :value="banner.logoWidth" v-model="banner.logoWidth" id="banner-logowidth">Logo Width </slider>
                </div>
              </div>
            </div>
            <div class="bannerValidWrapper" ref="bannerValidWrapper">
              <hr />
              <div class="row middle">
                <div class="col col-3" style="text-align: center; position: relative">
                  <img width="100%" style="max-width: 800px; border: 1px solid #eee" ref="bannerCreatedImage" alt="Created Banner" loading="lazy" />
                  <div class="bannerCreatedImageLoadingWrapper">
                    <i class="fas fa-circle-notch fa-2x"></i>
                  </div>
                </div>
                <div class="col col-left">
                  <div class="form-item" style="margin: 15px 8px">
                    <input type="checkbox" v-model="banner.displayGrid" id="banner-displayGrid" />
                    <label for="banner-displayGrid">Display Grid</label>
                  </div>
                  <div class="form-item" style="margin-top: 5px">
                    <input type="button" value="Download Custom Banner" @click="downloadCustomBanner" />
                  </div>
                  <p style="font-size: 0.75em; padding-left: 10px">Upload the banner to your website's uploads <br />library and copy the link to use it</p>
                </div>
              </div>
            </div>
          </div>
        </div> -->

        <div id="settings" class="main-view" :class="{open: app.activeView === 'settings'}">
          <div class="card">
            <h3 class="card-title">Reset Global/Individual Styles</h3>
            <p>
              <small>This will reset the styling of the global and individual posts of the newsletter</small>
            </p>
            <p>
              <small>Make sure to save your current newsletter if you think you may want to revert back to it.</small>
            </p>
            <div class="form-item">
              <button @click="resetStyles()" style="margin: 0"><i class="fas fa-remove-format"></i> Reset Styles</button>
            </div>
          </div>
        </div>

        <div id="help" class="main-view" :class="{open: app.activeView === 'help'}">
          <div class="card">
            <div class="form-item split even border" style="margin-top: 15px">
              <div>
                <searchbar element="helpCards">Search for help</searchbar>
              </div>
              <div></div>
            </div>
          </div>
          <div id="helpCards">
            <div class="card">
              <h3 class="card-title">How to <strong>Load / Save</strong> the Newsletter Options & Posts</h3>
              <p>
                <strong><small>If a newsletter has been saved locally you'll receive a popup in the bottom right to quickly load it.</small></strong>
              </p>
              <ol>
                <li>Go to the <strong>Load / Save</strong> tab</li>
                <li>Choose how you want to load/save the newsletter</li>
                <li style="list-style: none">
                  <ul>
                    <li><strong>Local</strong> will let you load/save the newsletter in your web browser.</li>
                    <li style="list-style: none">
                      <ul style="list-style-type: square">
                        <li><strong>Save the newsletter</strong> will save the newsletter in your web browser.</li>
                        <li><strong>Load the newsletter</strong> will load the newsletter from your web browser.</li>
                      </ul>
                    </li>
                    <li><strong>File</strong> will let you load/save the newsletter in a JSON file.</li>
                    <li style="list-style: none">
                      <ul style="list-style-type: square">
                        <li><strong>Save the newsletter</strong> will save the newsletter in a JSON file.</li>
                        <li><strong>Load the newsletter</strong> will load the newsletter from a JSON file.</li>
                      </ul>
                    </li>
                    <li><strong>Legacy</strong> only use this if you need to load/save with separate JSON files<br /><small>(No longer supported)</small></li>
                  </ul>
                </li>
              </ol>
            </div>
            <div class="card">
              <h3 class="card-title">How to <strong>Setup</strong> the Newsletter</h3>
              <p>
                <strong
                  ><small
                    >If you're using SiteForward's RSS Feed you can load posts from: <a href="http://siteforward.ca/rss-feed">http://siteforward.ca/rss-feed</a></small
                  ></strong
                >
              </p>
              <ol>
                <li>Go to the <strong>Setup</strong> tab</li>
                <li>
                  Add your blog posts
                  <small
                    >(Hover over the
                    <strong><i class="fas fa-question-circle" style="color: #aeaeae"></i></strong>
                    for tips)</small
                  >
                </li>
                <li style="list-style: none">
                  <ul style="list-style-type: square">
                    <li>
                      <strong>Load Multiple Posts</strong> will load blogs from your Twenty Over Ten blog page
                      <small>(You can even choose how many to load in using the number beside the field)</small>
                    </li>
                    <li>
                      <strong>Load Individual Posts</strong> lets you Load a single post from a Twenty Over Ten website
                      <small>(Use your blog post's URL link in this field)</small>
                    </li>
                  </ul>
                </li>
                <li>Choose your header option</li>
                <li style="list-style: none">
                  <ul style="list-style-type: square">
                    <li><strong>No Header</strong> will make it so no header appears</li>
                    <li><strong>Use Image</strong> allows you to use a banner image</li>
                    <li><strong>Use Titles</strong> allows you to enter your own title & subtitle</li>
                    <li><strong>Custom Header</strong> allows you to design your own header</li>
                  </ul>
                </li>
                <li>Choose your footer option</li>
                <li style="list-style: none">
                  <ul style="list-style-type: square">
                    <li><strong>No Footer</strong> will make it so no footer appears</li>
                    <li>
                      <strong>Use Template</strong> allows you to use a premade footer template
                      <small>(This will include the required disclaimers)</small>
                    </li>
                    <li><strong>Custom Footer</strong> allows you to design your own footer</li>
                  </ul>
                </li>
                <li>Optional: Customize each post's colours by clicking on the coloured box</li>
              </ol>
            </div>
            <div class="card">
              <h3 class="card-title">How to <strong>Edit</strong> the Newsletter</h3>
              <div class="row middle">
                <div class="col">
                  <ol>
                    <li>Go to the <strong>Edit Items</strong> tab</li>
                    <li>If you have loaded posts during setup you'll see a list of them here</li>
                    <li>
                      Clicking the
                      <strong><i class="far fa-plus-square" style="color: #aeaeae"></i></strong>
                      in the top right will create a new post
                    </li>
                    <li>
                      Clicking the
                      <strong><i class="fas fa-trash-alt" style="color: #aeaeae"></i></strong>
                      to the right of each post will remove that post
                    </li>
                    <li>
                      Clicking the
                      <strong><i class="far fa-clone" style="color: #aeaeae"></i></strong>
                      to the right of each post will clone that post
                    </li>
                    <li>
                      Clicking the
                      <strong><i class="fas fa-paint-brush" style="color: #aeaeae"></i></strong>
                      to the right of each post will allow you to edit the colours for that post
                    </li>
                    <li>Edit the contents of each post by clicking on the field and typing</li>
                    <li style="list-style: none">
                      <ul style="list-style-type: square">
                        <li>
                          <strong>Title</strong> will change the title of the post
                          <small>(Supports HTML)</small>
                        </li>
                        <li>
                          <strong>Description</strong> will change the description of the post
                          <small>(Supports HTML)</small>
                        </li>
                        <li>
                          <strong>Date</strong> will change the subtext under the post's title
                          <small>(Supports HTML)</small>
                        </li>
                        <li><strong>Link</strong> will change where the "Read More" button directs to</li>
                        <li><strong>Read More</strong> will change where the "Read More" button text</li>
                        <li><strong>Image URL</strong> will change the image to the left of the post</li>
                      </ul>
                    </li>
                    <li>Re-order your posts using the arrow head icons to the left of each post</li>
                    <li style="list-style: none">
                      <ul style="list-style-type: square">
                        <li>
                          <strong><i class="fas fa-chevron-up" style="color: #aeaeae"></i> <i class="fas fa-chevron-down" style="color: #aeaeae"></i></strong>
                          will move the post to the top/bottom
                        </li>
                        <li>
                          <strong><i class="fas fa-sort-up" style="color: #aeaeae"></i> <i class="fas fa-sort-down" style="color: #aeaeae; vertical-align: super"></i></strong>
                          will move the post up/down
                        </li>
                      </ul>
                    </li>
                  </ol>
                </div>
              </div>
            </div>
            <div class="card">
              <h3 class="card-title">How to <strong>Submit</strong> for Compliance Review</h3>
              <p>
                <strong><small>Always save your newsletter before submitting for compliance review, as the review process may take time.</small></strong>
              </p>
              <ol>
                <li>Go to the <strong>Use Newsletter</strong> tab and click <strong>Download PDF</strong></li>
                <li style="list-style: none">
                  <ul style="list-style-type: square">
                    <li>This creates a PDF version for compliance review</li>
                  </ul>
                </li>
                <li>Go to the <strong>Load / Save</strong> tab and save your newsletter</li>
                <li style="list-style: none">
                  <ul style="list-style-type: square">
                    <li>You'll need to come back to make changes after the review</li>
                    <li>Save locally (browser) or as a file on your computer</li>
                  </ul>
                </li>
                <li>Submit the PDF for compliance review in RedOak</li>
                <li>Make any required compliance changes</li>
                <li style="list-style: none">
                  <ul style="list-style-type: square">
                    <li>If you closed the page, reload your saved newsletter from the <strong>Load / Save</strong> tab</li>
                    <li>Edit your newsletter as needed in the <strong>Edit Items</strong> tab</li>
                  </ul>
                </li>
                <li>Once approved, you can use the newsletter from the <strong>Use Newsletter</strong> tab</li>
              </ol>
            </div>
            <div class="card">
              <h3 class="card-title">How to <strong>Use</strong> the Newsletter</h3>
              <ol>
                <li>Go to the <strong>Use Newsletter</strong> tab</li>
                <li><strong>Copy Code</strong> will copy the code to your clipboard</li>

                <li style="list-style: none">
                  <ul style="list-style-type: square">
                    <li>Use this if you're using a CRM and require HTML code</li>
                  </ul>
                </li>
                <li><strong>Copy Newsleter</strong> will copy the whole newsletter to your clipboard</li>

                <li style="list-style: none">
                  <ul style="list-style-type: square">
                    <li>Use this if you're using Outlook/Gmail or posting as a blog on your website</li>
                  </ul>
                </li>
                <li>Paste the newsletter/code to where you need it</li>
              </ol>
            </div>
            <!-- <div class="card">
                        <h3 class="card-title">How to use a <strong>Custom Banner</strong></h3>
                        <p><strong><small>Looking for pre-made banner images? Try SiteForward's image bank: <a
                                        href="https://siteforward.ca/tools/image-bank" target="_blank">https://siteforward.ca/tools/image-bank</a></small></strong></p>
                        <ol>
                            <li>Go to the <strong>Tools</strong> tab</li>
                            <li>Insert a banner image URL</li>
                            <li style="list-style: none;">
                                <ul style="list-style-type: square">
                                    <li><strong>Image Alignment</strong> is the alignment of your banner image</li>
                                </ul>
                            </li>
                            <li>Modify the title and subtitle</li>
                            <li style="list-style: none;">
                                <ul style="list-style-type: square">
                                    <li><strong>Title Size</strong> is the font size for your title</li>
                                    <li><strong>Subtitle Size</strong> is the font size for your subtitle</li>
                                    <li><strong>Title Spacing</strong> is the space between your title and subtitle</li>
                                    <li><strong>Text Vertical Offset</strong> is the vertical offset for your titles
                                    </li>
                                    <li><strong>Text Horizontal Offset</strong> is the horizontal offset for your titles
                                    </li>
                                    <li><strong>Text Alignment</strong> is the alignment of your titles</li>
                                </ul>
                            </li>
                            <li>Enable/Disable your shadow on your text</li>
                            <li style="list-style: none;">
                                <ul style="list-style-type: square">
                                    <li><strong>Shadow Vertical Offset</strong> is the offset on your shadow for the
                                        titles
                                    </li>
                                    <li><strong>Shadow Horizontal Offset</strong> is the offset on your shadow for the
                                        titles
                                    </li>
                                    <li><strong>Shadow Blur</strong> is the blurriness of the shadow</li>
                                </ul>
                            </li>
                            <li>Modify your logo image</li>
                            <li style="list-style: none;">
                                <ul style="list-style-type: square">
                                    <li><strong>Banner Logo URL</strong> is an image to inset on your banner</li>
                                    <li><strong>Logo Vertical Offset</strong> is the offset on your logo</li>
                                    <li><strong>Logo Horizontal Offset</strong> is the offset on your logo</li>
                                    <li><strong>Logo Width</strong> is the width of the logo image</li>
                                </ul>
                            </li>
                        </ol>
                    </div> -->
            <div class="card">
              <h3 class="cart-title">Newsletter Generator Changelog</h3>
              <p>
                To view the changelog for the Newsletter Generator click on the link below:<br />
                <a href="https://github.com/SiteForward/Newsletter-Generator/commits">https://github.com/SiteForward/Newsletter-Generator/commits</a>
              </p>

              <p></p>
            </div>
          </div>
        </div>
      </main>
    </div>
  </body>
  
  <!-- Configuration -->
  <script src="js\config\constants.js"></script>
  <script src="js\config\tinymce-config.js"></script>
  
  <!-- Utilities -->
  <script src="js\utils\color-utils.js"></script>
  <script src="js\utils\dom-utils.js"></script>
  <script src="js\utils\array-utils.js"></script>
  <script src="js\utils\validation-utils.js"></script>
  <script src="js\utils\notification-utils.js"></script>
  
  <!-- Services -->
  <script src="js\services\storage-service.js"></script>
  <script src="js\services\api-service.js"></script>
  <script src="js\services\export-service.js"></script>
  <script src="js\services\rss-service.js"></script>
  
  <!-- Components -->
  <script src="js\components\editable.js"></script>
  <script src="js\components\popup.js"></script>
  <script src="js\components\slider.js"></script>
  <script src="js\components\searchbar.js"></script>
  <script src="js\components\resizehandle.js"></script>
  
  <!-- Main Application -->
  <script src="js\app.js"></script>
</html>
